# Dungeon Warden: Crisis (DWC)

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![JavaScript](https://img.shields.io/badge/JavaScript-ES6+-yellow.svg)](https://www.ecma-international.org/)
[![HTML5](https://img.shields.io/badge/HTML-5-orange.svg)](https://html.spec.whatwg.org/)

🏰 **魔法のコアを守り抜け！戦略的タワーディフェンスゲーム**

迷路状のダンジョンマップで、罠とモンスターを駆使して侵入者から魔法のコアを守る、エンドレス型タワーディフェンスゲームです。

[🎮 プレイする（GitHub Pages）](#) | [📖 詳細なガイド](#ゲームガイド) | [🐛 バグ報告](https://github.com/yasutuna/dungeon-warden-crisis/issues)

---

## 📋 目次

- [🎯 ゲームの特徴](#-ゲームの特徴)
- [🚀 クイックスタート](#-クイックスタート)
- [📖 ゲームガイド](#-ゲームガイド)
  - [ゲームの目的](#ゲームの目的)
  - [マップの見方](#マップの見方)
  - [操作方法](#操作方法)
  - [リソース](#リソース)
- [⚔️ 罠システム](#️-罠システム)
- [✨ 罠の進化システム](#-罠の進化システム)
- [👹 モンスター](#-モンスター)
- [⚔️ 敵の種類](#️-敵の種類)
- [📈 Wave進行](#-wave進行)
- [💡 攻略のコツ](#-攻略のコツ)
- [🛠️ 技術情報](#️-技術情報)
- [📜 ライセンス](#-ライセンス)

---

## 🎯 ゲームの特徴

- **🗺️ 戦略的なマップデザイン**：迷路状のマップ、落とし穴、空中ルートを活用した高度な戦略性
- **⚔️ 豊富な罠とモンスター**：30種類以上の罠と15種類以上のモンスターを使い分け
- **✨ 罠の進化システム**：隣接する罠を合成して強力な罠を生み出す独自システム
- **📈 エンドレスモード**：Wave15ごとにボスが登場し、マップが切り替わる無限挑戦
- **🎮 直感的な操作**：クリックだけで配置・修理・売却が可能
- **🔥 コンボシステム**：油濡れ+火炎、凍結、毒など多彩な状態異常の組み合わせ

---

## 🚀 クイックスタート

### プレイ方法（ブラウザで直接）

1. **index.htmlを開く**
   ```bash
   # ローカルでプレイする場合
   open index.html
   ```

2. **ローカルサーバーで起動**（推奨）
   ```bash
   # Python 3の場合
   python -m http.server 8000
   
   # Node.jsの場合
   npx serve
   ```
   
   その後、ブラウザで `http://localhost:8000` にアクセス

3. **遊び方**
   - 左パネルから罠を選択してグリッドに配置
   - 右パネルからモンスターを選択してグリッドに配置
   - 準備ができたら「Wave開始」ボタンをクリック
   - コアのHPを守りながらできるだけ長く生き残ろう！

---

## 📖 ゲームガイド

### ゲームの目的

🎯 **エンドレスモードで可能な限り高いスコアを獲得すること！**

- コアのHPが0になったらゲームオーバー
- Wave15ごとにボスが出現し、撃破すると次のステージへ進む（マップ切替）
- Wave16以降は複数スポーン、Wave30以降は3つのスポーンから敵が出現

### マップの見方

| シンボル | 説明 |
|---------|------|
| 🟢 明るい緑色 (S) | **スポーン地点** - 敵が出現する場所 |
| 🔴 明るい赤色 (C) | **コア** - 守るべき目標 |
| ◼️ グレー | **敵の移動経路**（pathタイル） |
| ⬛ 濃いグレー | **空き地** - 罠とモンスターを配置可能 |
| 🟣 紫色 | **空中ルート** - 飛行ユニット専用の迂回路 |
| ⬛ 濃い黒色 | **落とし穴** - 敵を押し出すと落下ダメージ |

> 💡 **ヒント**: 紫の空中ルートは地上敵を避けた高速移動が可能。落とし穴は押し出しトラップとのコンボで効果を発揮！

### 操作方法

- **配置**: 左パネル/右パネルから罠/モンスターをクリック → グリッド上の空きマスをクリック
- **選択**: 配置済みの罠/モンスターをクリックで選択・詳細表示
- **修理**: 選択中の罠を修理ボタンで修理（ソウル消費）
- **売却**: 選択中の罠/モンスターを売却ボタンで売却
- **キャンセル**: 右クリックで配置モードをキャンセル
- **進化**: 隣接する2つの罠を選択して進化（対応する組み合わせのみ）
- **情報表示**: マウスホバーでアイテムやオブジェクトの詳細情報を表示

### リソース

- **💜 ソウル**: 罠とモンスターの購入・修理に使用。敵を倒すと獲得

---

## ⚔️ 罠システム

### 基本罠
| 罠 | コスト | 解禁Wave | 効果 |
|----|--------|----------|------|
| ▲ スパイク板 | 60 | 初期 | 通過時にダメージと出血DoT |
| ➤ 矢壁 | 80 | 初期 | 最前列の敵を自動攻撃。**進化可能** |
| 💧 油壺 | 70 | 初期 | 油濡れ状態を付与（火炎ダメージ+50%） |
| 🌀 減速フィールド | 70 | 初期 | 通過時に速度50%減少。**進化可能** |
| 🌺 ベノムブロッサム | 110 | 初期 | 強力な毒DOT+回復40%減少。**進化可能** |
| ❄ 氷結床 | 90 | Wave3 | 鈍足＋凍結スタック |
| ⬅ 押出板 | 85 | Wave5 | ノックバック効果 |
| 💣 地雷 | 90 | Wave5 | 踏むと爆発（使い捨て） |
| 🔥 火炎孔 | 100 | Wave7 | 範囲火炎DoT攻撃 |
| ❓ 反転符 | 75 | Wave8 | 優先順位を乱す |

### 上級罠

| 罠 | コスト | 解禁Wave | 効果 |
|----|--------|----------|------|
| ⚡ 雷の柱 | 110 | Wave9 | 電撃が3体に連鎖攻撃 |
| 🩸 吸血の棘 | 95 | Wave9 | ダメージの50%を自己回復 |
| 🌀 重力井戸 | 105 | Wave9 | 敵を引き寄せて減速 |
| ☠ 毒霧発生器 | 100 | Wave10 | 毒DOT+回復50%減少 |
| 🪞 反射の鏡 | 130 | Wave10 | 受けたダメージの40%を反射 |
| ⏰ 時空歪曲器 | 140 | Wave10 | 速度60%低下+スキルCD増加 |
| ⚰ 呪いの祭壇 | 115 | Wave5 | 呪いDOT+被ダメ15%増加 |
| ✨ 聖なる結界 | 125 | Wave12 | 味方モンスターに被ダメ軽減+回復 |
| 💀 ソウル収穫機 | 120 | Wave12 | 範囲内で敵を倒すとソウル+3ボーナス |
| 🧪 酸の水溜り | 85 | Wave13 | 通過時に酸DoTダメージ |
| ⚡ 電撃ネット | 90 | Wave14 | 範囲スタン攻撃 |
| 🔫 機関砲塔 | 110 | Wave13 | 自動追尾射撃 |

---

## ✨ 罠の進化システム

隣接する異なる罠を合成して、より強力な罠に進化させることができます！

### 矢壁の進化パターン

| 素材1 | + | 素材2 | → | 進化後 | 効果 |
|------|---|------|---|--------|------|
| ➤ 矢壁 | + | ➤ 矢壁 | → | **高速矢壁** | 連射強化 |
| ➤ 矢壁 | + | 🔥 火炎孔 | → | **炎の矢壁** | 火炎属性攻撃 |
| ➤ 矢壁 | + | ❄ 氷結床 | → | **氷の矢壁** | 凍結効果 |
| ➤ 矢壁 | + | ☠ 毒霧/ベノム | → | **毒の矢壁** | 毒属性攻撃 |
| ➤ 矢壁 | + | ⚡ 雷の柱 | → | **雷の矢壁** | 連鎖攻撃 |
| ➤ 矢壁 | + | ⚰ 呪いの祭壇 | → | **呪いの矢壁** | 呪い付与 |

### その他の進化パターン

| 素材1 | + | 素材2 | → | 進化後 | 効果 |
|------|---|------|---|--------|------|
| 💧 油壺 | + | 🔥 火炎孔 | → | **業火の罠** | 大炎上ダメージ |
| 🌺 ベノムブロッサム | + | 🌀 減速地帯 | → | **毒沼** | 強力な毒+移動不可 |

> 💡 **ヒント**: 進化した罠は元の罠よりも遥かに強力です。戦略的に配置して進化させましょう！

---

## 👹 モンスター

### 初期解禁

| モンスター | コスト | HP | 特徴 |
|-----------|--------|-----|------|
| 💀 スケルトン兵 | 90 | 200 | 前衛タンク。死亡時50%で復活(Lv毎+1%、最大80%) |
| 🟢 スライム | 80 | 260 | 鈍足攻撃。被ダメ時30%で分裂 |
| 🔧 ゴブリン工兵 | 100 | 140 | 罠を自動修理。敵撃破時5%でソウル+5 |
| 💀 魔王 | 500 | 250 | 移動不可。スライム5体以上で10秒毎にユニット変換。攻撃で回復。**1体のみ召喚可能** |

### Wave解禁

| モンスター | コスト | HP | 解禁 | 特徴 |
|-----------|--------|-----|------|------|
| 🧟 ゾンビ | 70 | 300 | Wave2 | 遅いが頑丈。敵をゾンビ化 |
| 🏹 骨の射手 | 110 | 160 | Wave3 | 貫通遠隔攻撃 |
| 🐺 地獄の猟犬 | 95 | 180 | Wave4 | 高速移動、撃破時HP回復 |
| 🦅 ガーゴイル | 120 | 200 | Wave6 | 飛行ユニット、対空専門 |
| 👤 影の暗殺者 | 150 | 150 | Wave6 | 高火力クリティカル |
| ❄ 氷結魔導師 | 140 | 170 | Wave7 | 凍結攻撃、氷のオーラ |
| ☠ ネクロマンサー | 180 | 130 | Wave8 | スケルトン召喚 |
| ✨ ウィスプ | 110 | 120 | Wave11 | 魔法攻撃、味方回復 |
| 🗿 石のゴーレム | 160 | 400 | Wave11 | 超タンク、挑発 |
| 🦇 吸血鬼 | 170 | 200 | Wave12 | 吸血攻撃で回復 |
| ✝ 聖職者スケルトン | 130 | 180 | Wave13 | 範囲回復ヒーラー |

---

## ⚔️ 敵の種類

| 敵 | HP | 特徴 |
|----|-----|------|
| 🗡 盗賊 | 120 | 罠検知・回避・解除能力。罠が近いと減速 |
| ⚔ 戦士 | 280 | 高HP前衛。HP50%以下で1.3倍加速 |
| 🏹 レンジャー | 160 | 遠距離攻撃。モンスターから距離を取る |
| ✝ 聖職者 | 170 | 味方を回復・状態異常解除。**優先的に倒すべき** |
| 🔮 エレメンタリスト | 190 | 範囲魔法攻撃 |
| 🛡 攻城兵 | 350 | 超高HP。罠への遠隔攻撃 |
| 🦅 飛行斥候 | 140 | 地上罠を無視。空中ルート使用 |
| 👑 光の勇者 | 1200 | **ボス**。バリア、自己回復、聖域スキル |

> ⚠️ **重要**: 敵は状況に応じてルートを変更します。柔軟な戦略が必要です。

---
## 📈 Wave進行

### 第1ステージ（Wave1-15）

| Wave | 解禁内容 | 備考 |
|------|---------|------|
| Wave2 | スケルトン兵、ゾンビ | - |
| Wave3 | 氷結床、骨の射手 | - |
| Wave4 | ゴブリン工兵、地獄の猟犬 | - |
| Wave5 | 呪いの祭壇、押し出し板、地雷 | **ミニボス** |
| Wave6 | ガーゴイル、影の暗殺者 | - |
| Wave7 | 火炎孔、氷結魔導師 | - |
| Wave8 | 反転符、ネクロマンサー | - |
| Wave9 | 雷の柱、吸血の棘、重力井戸 | - |
| Wave10 | 反射の鏡、毒霧発生器、時空歪曲器 | **ミニボス** |
| Wave11 | ウィスプ、石のゴーレム | - |
| Wave12 | 吸血鬼、聖なる結界、ソウル収穫機 | - |
| Wave13 | 聖職者スケルトン、酸の水溜り、機関砲塔 | - |
| Wave14 | ハーピー、天空騎士、電撃ネット | - |
| Wave15 | - | **第1ボス「光の勇者」出現** |

### 第2ステージ以降（Wave16+）

| Wave | 内容 |
|------|------|
| Wave16+ | **2つのスポーン地点**から敵が出現 |
| Wave20 | **第2ボス「使徒」**出現 |
| Wave25 | **第3ボス「光の勇者×2 + 使徒」**出現 |
| Wave30 | **第4ボス「光の勇者×3 + 使徒×2」**出現 |
| Wave30+ | **3つのスポーン地点**から敵が出現 |

> 📝 **メモ**: Wave15までに全ての罠とモンスターが解禁されます。ボスWaveではより強力な敵編成が登場し、ステージが進むほど敵のレベルと数が増加します。

---

## 💡 攻略のコツ

### 序盤戦略（Wave1-5）
- 🔧 **ゴブリン工兵を早めに配置**して罠の耐久を維持
- 💧 **油壺→火炎孔のルート**を作って業火コンボを準備
- ▲ **スパイク板**で序盤の敵を確実に削る

### 中盤戦略（Wave6-10）
- ❄ **氷結床**で敵を遅らせて集中攻撃
- ➤ **矢壁を進化**させて属性矢壁を作成（火炎、氷、毒、雷など）
- ✝ **聖職者を優先的に倒す**（反転符が有効）
- 🦅 **飛行敵にはガーゴイル**や矢壁系で対応

### 終盤戦略（Wave11+）
- 🌺 **ベノムブロッサム+減速地帯=毒沼**（強力な毒DOT+移動不可）
- ⬅ **押し出しトラップで敵を落とし穴**に押し込む
- 💀 **魔王+スライム**の組み合わせでユニット変換を活用
- 🗿 **石のゴーレムの挑発**で敵を引き付けて防衛ライン構築

### ボス戦略
- 📊 **Wave間で戦略を見直し**、罠とモンスターを配置し直す
- ⚡ **進化システムを最大限活用**して強力な罠を作る
- 🎯 **複数スポーンに対応**した配置を心がける

---

## 🛠️ 技術情報

### 使用技術

- **言語**: JavaScript (ES6+)
- **UI**: HTML5 + CSS3
- **アルゴリズム**: 
  - A*経路探索（敵の経路計算）
  - QuadTree（衝突判定の最適化）
  - Object Pooling（パフォーマンス最適化）
  - Priority Queue（効率的な経路探索）

### ファイル構成

```
dungeon-warden-crisis/
├── index.html           # メインHTMLファイル
├── style.css           # スタイルシート
├── js/
│   ├── game.js         # ゲームメインループ
│   ├── grid.js         # グリッドシステム
│   ├── trap.js         # 罠システム
│   ├── monster.js      # モンスターシステム
│   ├── enemy.js        # 敵システム
│   ├── combat.js       # 戦闘システム
│   ├── ui.js           # UIシステム
│   ├── waveManager.js  # Waveマネージャー
│   ├── pathfinding.js  # 経路探索
│   ├── quadtree.js     # QuadTree実装
│   ├── objectPool.js   # Object Pool実装
│   ├── priorityQueue.js # Priority Queue実装
│   ├── statusEffects.js # 状態異常システム
│   ├── constants.js    # 定数定義
│   └── utils.js        # ユーティリティ関数
├── data/
│   ├── traps.js        # 罠データ
│   ├── monsters.js     # モンスターデータ
│   ├── enemies.js      # 敵データ
│   └── waves.js        # Wave構成データ
├── CONFIG.md           # 設定ガイド
├── IMPROVEMENTS.md     # 改善提案
└── README.md          # このファイル
```

### カスタマイズ

ゲームバランスや設定をカスタマイズする方法は [CONFIG.md](CONFIG.md) を参照してください。

---

## 🎮 開発者向け情報

### ローカル開発

```bash
# リポジトリのクローン
git clone https://github.com/yasutuna/dungeon-warden-crisis.git
cd dungeon-warden-crisis

# ローカルサーバーの起動（例：Python）
python -m http.server 8000

# ブラウザでアクセス
open http://localhost:8000
```

### デバッグモード

ブラウザの開発者ツール（F12）でコンソールを開くと、ゲームの内部状態が確認できます。

---

## 🤝 コントリビューション

バグ報告、機能提案、プルリクエストは大歓迎です！

1. このリポジトリをFork
2. 機能ブランチを作成 (`git checkout -b feature/AmazingFeature`)
3. 変更をコミット (`git commit -m 'Add some AmazingFeature'`)
4. ブランチにプッシュ (`git push origin feature/AmazingFeature`)
5. Pull Requestを作成

---

## 📜 ライセンス

このプロジェクトはMITライセンスの下で公開されています - 詳細は [LICENSE](LICENSE) ファイルを参照してください。

---

## 📞 お問い合わせ

プロジェクトについての質問や提案は、[Issues](https://github.com/yasutuna/dungeon-warden-crisis/issues)で受け付けています。

---

## 🎉 謝辞

このゲームを楽しんでいただきありがとうございます！

**高スコアを目指して頑張ってください！** 🏆

---

**Made with ❤️ by [yasutuna](https://github.com/yasutuna)**
